{"version":3,"file":"ngx-simple-countdown.js","sources":["ng://ngx-simple-countdown/lib/ngx-simple-countdown.directive.ts","ng://ngx-simple-countdown/lib/ngx-simple-countdown.module.ts","ng://ngx-simple-countdown/public_api.ts","ng://ngx-simple-countdown/ngx-simple-countdown.ts"],"sourcesContent":["import { Directive, Input, ElementRef, OnDestroy, OnInit } from '@angular/core';\nimport * as fromModel from './models';\nimport { interval, Observable, ReplaySubject } from 'rxjs';\nimport { tap, takeUntil, filter } from 'rxjs/operators';\n\n@Directive({\n  selector: '[simpleCountdown]'\n})\nexport class NgxSimpleCountdownDirective implements OnInit, OnDestroy {\n  @Input() dateTo: number;\n  @Input() language = 'en';\n  @Input() reactive = true;\n  @Input() endMessage = 'countdown finish';\n  @Input() hideUnit = '';\n  @Input() styles =\n    'font-size:20px;color:#FFF;background-color:#000;padding:10px 5px;font-weight:bold;min-width:40px;text-align:center;';\n\n  public keywords: fromModel.CountdownKeywords;\n  public countdownResult: fromModel.CountdownResult;\n  public dateNow: number;\n  public totalSecondes: number;\n  public interval$: Observable<number>;\n\n  constructor(private elementRef: ElementRef) {}\n\n  ngOnInit() {\n    this.getDateNow();\n    this.setLanguage(this.language);\n    this.initSimpleCountdown();\n  }\n\n  ngOnDestroy() {}\n\n  private initSimpleCountdown(): void {\n    this.totalSecondes = this.dateTo - this.dateNow;\n    this.countdownResult = this.updateSimpleCountdown(this.totalSecondes);\n    this.createHTML();\n\n    this.interval$ = interval(1000).pipe(\n      takeUntil(this.componentDestroyed(this)),\n      filter(_ => this.reactive && this.totalSecondes > 0),\n      tap(_ => this.totalSecondes--),\n      tap(\n        _ =>\n          (this.countdownResult = this.updateSimpleCountdown(\n            this.totalSecondes\n          ))\n      ),\n      tap(_ => this.createHTML())\n    );\n\n    this.interval$.subscribe();\n  }\n\n  private createHTML(): void {\n    let o = '';\n\n    if (this.totalSecondes > 0) {\n      o = '<div style=\"display:flex;\">';\n\n      if (this.isContent('d')) {\n        if (this.countdownResult.day > 0) {\n          o += `<div style=\"${this.styles}\">\n          ${this.countdownResult.day}${this.keywords.day}\n          </div>`;\n        }\n      }\n\n      if (this.isContent('h')) {\n        if (this.countdownResult.hours > 0 || this.countdownResult.day > 0) {\n          o += `<div style=\"${this.styles}\">\n          ${this.countdownResult.hours}${this.keywords.hours}\n        </div>`;\n        }\n      }\n\n      if (this.isContent('m')) {\n        if (\n          (this.countdownResult.minutes > 0 ||\n            this.countdownResult.hours > 0 ||\n            this.countdownResult.day > 0) &&\n          this.reactive\n        ) {\n          o += `<div style=\"${this.styles}\">\n          ${this.countdownResult.minutes}${this.keywords.minutes}\n        </div>`;\n        }\n      }\n\n      if (this.isContent('s')) {\n        if (\n          (this.countdownResult.seconds > 0 ||\n            this.countdownResult.minutes > 0 ||\n            this.countdownResult.hours > 0 ||\n            this.countdownResult.day > 0) &&\n          this.reactive\n        ) {\n          o += `<div style=\"${this.styles}\">\n          ${this.countdownResult.seconds}${this.keywords.seconds}\n        </div>`;\n        }\n        o += '</div>';\n      }\n    } else {\n      if (this.endMessage !== '') {\n        o += `<div style=\"${this.styles}\">${this.endMessage}</div>`;\n      }\n    }\n\n    this.elementRef.nativeElement.innerHTML = o;\n  }\n\n  private isContent(unit: string): boolean {\n    return !this.hideUnit.includes(unit);\n  }\n\n  private updateSimpleCountdown(secondes: number): fromModel.CountdownResult {\n    const Seconds = Math.floor((secondes / 1) % 60);\n    const Minutes = Math.floor((secondes / 1 / 60) % 60);\n    const Hours = Math.floor((secondes / (1 * 60 * 60)) % 24);\n    const Day = Math.floor(secondes / (1 * 60 * 60 * 24));\n\n    return {\n      day: Day,\n      hours: Hours,\n      minutes: Minutes,\n      seconds: Seconds\n    };\n  }\n\n  private getDateNow(): void {\n    this.dateNow = Math.floor(Date.now() / 1000);\n  }\n\n  private setLanguage(language: string): void {\n    if (language === 'fr') {\n      this.keywords = {\n        seconds: 's',\n        minutes: 'm',\n        hours: 'h',\n        day: 'j'\n      };\n    } else if (language === 'de') {\n      this.keywords = {\n        seconds: 'z',\n        minutes: 'm',\n        hours: 's',\n        day: 't'\n      };\n    } else if (language === 'es' || language === 'pt') {\n      this.keywords = {\n        seconds: 's',\n        minutes: 'm',\n        hours: 's',\n        day: 'd'\n      };\n    } else if (language === 'cs') {\n      this.keywords = {\n        seconds: 's',\n        minutes: 'm',\n        hours: 'h',\n        day: 'd'\n      };\n    } else if (language === 'pl') {\n      this.keywords = {\n        seconds: 's',\n        minutes: 'm',\n        hours: 'g',\n        day: 'd'\n      };\n    } else {\n      this.keywords = {\n        seconds: 's',\n        minutes: 'm',\n        hours: 'h',\n        day: 'd'\n      };\n    }\n  }\n\n  private componentDestroyed(component: OnDestroy) {\n    const oldNgOnDestroy = component.ngOnDestroy;\n    const destroyed$ = new ReplaySubject<void>(1);\n    component.ngOnDestroy = () => {\n      oldNgOnDestroy.apply(component);\n      destroyed$.next(undefined);\n      destroyed$.complete();\n    };\n    return destroyed$;\n  }\n}\n","import { NgModule } from \"@angular/core\";\nimport { NgxSimpleCountdownDirective } from \"./ngx-simple-countdown.directive\";\n\n@NgModule({\n  declarations: [NgxSimpleCountdownDirective],\n  imports: [],\n  exports: [NgxSimpleCountdownDirective]\n})\nexport class NgxSimpleCountdownModule {}\n","/*\n * Public API Surface of ngx-simple-countdown\n */\n\nexport * from './lib/ngx-simple-countdown.module';\nexport * from './lib/ngx-simple-countdown.directive';\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public_api';\n"],"names":[],"mappings":"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"}